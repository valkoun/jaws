function insertTags(a,c,e,f){var b=navigator.userAgent.toLowerCase().indexOf("gecko")!=-1;if(document.selection&&!b)(b=document.selection.createRange().text)||(b=f),a.focus(),b.charAt(b.length-1)==" "?(b=b.substring(0,b.length-1),document.selection.createRange().text=c+b+e+" "):document.selection.createRange().text=c+b+e;else if(a.selectionStart||a.selectionStart=="0"){var g=a.selectionStart,h=a.selectionEnd,b=a.scrollTop,d=a.value.substring(g,h);d||(d=f);subst=d.charAt(d.length-1)==" "?c+d.substring(0, d.length-1)+e+" ":c+d+e;a.value=a.value.substring(0,g)+subst+a.value.substring(h,a.value.length);a.focus();c=g+(c.length+d.length+e.length);a.selectionStart=c;a.selectionEnd=c;a.scrollTop=b}else g=RegExp("\\$2","g"),b=alertText.replace(RegExp("\\$1","g"),f),b=b.replace(g,c+f+e),(b=f?prompt(b):"")||(b=f),a.value+="\n"+(c+b+e),is_safari||a.focus();if(a.createTextRange)a.caretPos=document.selection.createRange().duplicate()};